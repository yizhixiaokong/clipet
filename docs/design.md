# Clipet â€” ç»ˆç«¯å® ç‰©ä¼´ä¾£ è®¾è®¡æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

Clipet æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ç»ˆç«¯ä¸­çš„å® ç‰©å…»æˆç¨‹åºï¼ˆTUIï¼‰ï¼Œä»¥ ASCII åƒç´ é£åŠ¨ç”»ä¸ºæ ¸å¿ƒè§†è§‰è¡¨ç°ï¼Œ
æ”¯æŒå–‚é£Ÿã€å¿ƒæƒ…ã€æˆé•¿è¿›åŒ–ã€è¿·ä½ æ¸¸æˆã€å¯¹è¯ã€æ•°æ®æŒä¹…åŒ–ç­‰å®Œæ•´äº¤äº’ç³»ç»Ÿã€‚

### é¡¹ç›®å®šä½

- **ç±»å‹**: ç»ˆç«¯æ¡Œå®  / TUI å…»æˆæ¸¸æˆ
- **é£æ ¼**: ç§‘å¹» + å¥‡å¹»æ··æ­ï¼ˆFantasy Adventureï¼‰
- **è¿è¡Œæ¨¡å¼**: æ··åˆæ¨¡å¼ â€” å…¨å± TUI äº¤äº’ + CLI å¿«æ·å‘½ä»¤

## æŠ€æœ¯æ ˆ

| ç»„ä»¶          | é€‰å‹                             | ç‰ˆæœ¬     |
|---------------|----------------------------------|----------|
| è¯­è¨€          | Go                               | 1.25+    |
| TUI æ¡†æ¶      | Bubble Tea v2                    | 2.0.0    |
| æ ·å¼          | Lipgloss v2                      | 2.0.0    |
| TUI ç»„ä»¶      | Bubbles v2                       | 2.0.0 (é—´æ¥ä¾èµ–) |
| CLI æ¡†æ¶      | Cobra                            | 1.10.2   |
| é…ç½®æ ¼å¼      | TOML (BurntSushi/toml)           | 1.6.0    |
| å›½é™…åŒ–        | è‡ªç ”è½»é‡çº§ i18n æ¡†æ¶              | â€”        |
| åŠ¨ç”»ç¼“åŠ¨      | Harmonica                        | 0.2.0 (é—´æ¥ä¾èµ–) |

> **æ³¨æ„**: Bubble Tea v2 ä½¿ç”¨ `charm.land/bubbletea/v2` å¯¼å…¥è·¯å¾„ï¼Œ
> ä¸æ˜¯ `github.com/charmbracelet/bubbletea/v2`ã€‚Lipgloss v2 å’Œ Bubbles v2 åŒç†ã€‚

## æ ¸å¿ƒç‰¹æ€§

### 1. ASCII åƒç´ é£åŠ¨ç”»

- å¤šå¸§åŠ¨ç”»ç³»ç»Ÿï¼šidleã€eatingã€sleepingã€playingã€happyã€sad ç­‰çŠ¶æ€
- å¸§æ–‡ä»¶å­˜å‚¨åœ¨ç‰©ç§åŒ… `frames/` ç›®å½•ï¼ŒæŒ‰é˜¶æ®µåˆ†çº§ç»„ç»‡
- æ¨èå¤šçº§ç›®å½•ï¼š`frames/{phase}/{variant}/idle.txt`ï¼ˆè·¯å¾„æ‹¼æ¥ä¸º stageIDï¼‰
- æ”¯æŒç²¾çµå›¾æ ¼å¼ï¼š`{animState}.txt`ï¼ˆå¤šå¸§ç”¨ `---` åˆ†éš”ï¼‰
- å…¼å®¹æ ¹çº§æ ¼å¼ï¼š`{stageID}_{animState}.txt` å’Œé€å¸§ `{stageID}_{animState}_{index}.txt`
- å¸§åˆ‡æ¢é‡‡ç”¨å®šæ—¶å™¨é©±åŠ¨

### 2. å±æ€§ç³»ç»Ÿ

å››é¡¹æ ¸å¿ƒå±æ€§ï¼ˆ0-100ï¼‰ï¼š

| å±æ€§       | è¯´æ˜                  | æ“ä½œå½±å“ï¼ˆbaseå€¼ï¼‰               |
|------------|----------------------|---------------------------------|
| Hunger     | é¥±è…¹åº¦ï¼Œè¶Šé«˜è¡¨ç¤ºè¶Šé¥±  | Feed +25                        |
| Happiness  | å¿«ä¹åº¦               | Play +20, Feed +5, Talk +5, Rest -5 |
| Health     | å¥åº·å€¼               | Heal +25, Rest +5               |
| Energy     | ç²¾åŠ›å€¼               | Rest +30, Play -10, Heal -15    |

#### æ”¶ç›Šé€’å‡

æ‰€æœ‰å¢ç›Šæ“ä½œä½¿ç”¨é€’å‡å…¬å¼ï¼Œå±æ€§è¶Šæ¥è¿‘æ»¡å€¼å¢é•¿è¶Šå°ï¼š

```
gain = base Ã— (100 - current) / 100   (æœ€å°ä¸º 1)
```

ä¾‹å¦‚ï¼šFeed base=25ï¼Œå½“å‰ Hunger=80 æ—¶å®é™…å¢ç›Š = 25Ã—20/100 = 5ã€‚

#### å±æ€§è¡°å‡ï¼ˆæ ¸å¿ƒæœºåˆ¶ï¼‰

å±æ€§éš**ç°å®æ—¶é—´**è‡ªç„¶è¡°å‡ï¼Œå³ä½¿ç¨‹åºæœªè¿è¡Œã€‚**è¡°å‡ç‡ç”±æ’ä»¶é…ç½®æ§åˆ¶**ï¼ˆPhase 7+ï¼‰ï¼š

**é»˜è®¤è¡°å‡ç‡**ï¼ˆçŒ«ç‰©ç§ï¼‰ï¼š

| å±æ€§       | è¡°å‡é€Ÿç‡      | è¯´æ˜                           |
|------------|--------------|--------------------------------|
| Hunger     | -1.0 / å°æ—¶  | ç»Ÿä¸€æ…¢é€Ÿè¡°å‡                   |
| Happiness  | -0.5 / å°æ—¶  | ç»Ÿä¸€æ…¢é€Ÿè¡°å‡                   |
| Energy     | -0.3 / å°æ—¶  | ç»Ÿä¸€æ…¢é€Ÿè¡°å‡                   |
| Health     | -0.2 / å°æ—¶  | ä»…åœ¨ Hunger < 20 æ—¶è§¦å‘        |

**æ’ä»¶å¯é…ç½®**ï¼ˆspecies.toml `[decay]` æ®µï¼‰ï¼š

```toml
[decay]
hunger = 1.0        # ä¸åŒç‰©ç§å¯ä»¥æœ‰ä¸åŒçš„è¡°å‡ç‡
happiness = 0.5
energy = 0.3
health = 0.2
```

**è®¾è®¡ç†å¿µ**ï¼š
- **ç»Ÿä¸€æ…¢é€Ÿè¡°å‡**ï¼šé€‚åˆç¦»çº¿æ¸¸æˆï¼Œç©å®¶æ— éœ€é•¿æ—¶é—´åœ¨çº¿
- **ç¦»çº¿å‹å¥½**ï¼šå³ä½¿ç¦»çº¿æ•°å¤©ï¼Œå® ç‰©çŠ¶æ€ä»å¯æ§
- **å¯æ‰©å±•æ€§**ï¼šä¸åŒç‰©ç§å¯ä»¥æœ‰ä¸åŒçš„ç»´æŠ¤éš¾åº¦

ç¦»çº¿è¡¥å¿ï¼šç¨‹åºå¯åŠ¨æ—¶è®¡ç®— `time.Since(LastCheckedAt)` å¹¶ä¸€æ¬¡æ€§æ‰£é™¤è¡°å‡é‡ã€‚

#### æ­»äº¡æœºåˆ¶

- **è§¦å‘æ¡ä»¶**: Health é™è‡³ 0
- **æ°¸ä¹…æ€§**: å½“å‰ç‰ˆæœ¬æ­»äº¡ä¸å¯é€†ï¼Œæ— å¤æ´»æœºåˆ¶
- **è¡Œä¸º**: æ­»äº¡åæ‰€æœ‰æ“ä½œè¿”å› "å® ç‰©å·²ç»ä¸åœ¨äº†..."
- **å…¸å‹æ­»äº¡è·¯å¾„**: é•¿æœŸä¸å–‚é£Ÿ â†’ é¥±è…¹å½’é›¶ â†’ å¥åº·æŒç»­ä¸‹é™ â†’ å¥åº·å½’é›¶ â†’ æ­»äº¡
- ä»æ»¡å±æ€§åˆ°é¥¿æ­»å¤§çº¦éœ€è¦ **~40 å°æ—¶**æŒç»­å¿½è§†

#### æ“ä½œå†·å´ä¸åŠ¨æ€ç³»ç»Ÿ

**åŸºç¡€å†·å´æ—¶é—´**ï¼ˆç”±æ’ä»¶é…ç½®æ§åˆ¶ï¼ŒPhase 7+ï¼‰ï¼š

æ¯ä¸ªæ“ä½œæœ‰æœ€ä½é—´éš”æ—¶é—´ï¼Œé˜²æ­¢æ— é™åˆ·å±æ€§ï¼š

| æ“ä½œ    | åŸºç¡€å†·å´ | å‰ç½®æ¡ä»¶       | æ’ä»¶å¯é…ç½® |
|---------|---------|----------------|-----------|
| Feed    | 10 åˆ†é’Ÿ | Hunger < 95    | âœ… |
| Play    | 5 åˆ†é’Ÿ  | Energy â‰¥ 10    | âœ… |
| Talk    | 2 åˆ†é’Ÿ  | â€”              | âœ… |
| Rest    | 15 åˆ†é’Ÿ | Energy < 90    | âœ… |
| Heal    | 20 åˆ†é’Ÿ | Energy â‰¥ 10    | âœ… |
| å†’é™©    | 10 åˆ†é’Ÿ | Energy â‰¥ 15    | âœ… |

**åŠ¨æ€å†·å´ç³»ç»Ÿ**ï¼ˆPhase 7+ï¼‰ï¼š

å†·å´æ—¶é—´æ ¹æ®å±æ€§ç´§æ€¥åº¦åŠ¨æ€è°ƒæ•´ï¼Œå¸®åŠ©ç©å®¶åº”å¯¹ç´§æ€¥æƒ…å†µï¼š

```toml
[dynamic_cooldown]
# å½“å±æ€§å¾ˆä½ï¼ˆ< 30ï¼‰ï¼šå†·å´æçŸ­ï¼ˆ10% åŸºç¡€å†·å´ï¼‰
low_urgency_multiplier = 0.1
low_threshold = 30

# å½“å±æ€§ä¸­ç­‰ï¼ˆ30-70ï¼‰ï¼šå†·å´é€‚ä¸­ï¼ˆ50% åŸºç¡€å†·å´ï¼‰
medium_urgency_multiplier = 0.5

# å½“å±æ€§è¾ƒé«˜ï¼ˆ>= 70ï¼‰ï¼šå†·å´æ­£å¸¸ï¼ˆ100% åŸºç¡€å†·å´ï¼‰
high_urgency_multiplier = 1.0
high_threshold = 70
```

**ç¤ºä¾‹**ï¼ˆåŸºç¡€å–‚é£Ÿå†·å´ = 10 åˆ†é’Ÿï¼‰ï¼š
- é¥±é£Ÿåº¦ = 10 â†’ å†·å´ = 1 åˆ†é’Ÿï¼ˆç´§æ€¥å¸®åŠ©ï¼‰
- é¥±é£Ÿåº¦ = 50 â†’ å†·å´ = 5 åˆ†é’Ÿï¼ˆä¸­ç­‰ï¼‰
- é¥±é£Ÿåº¦ = 85 â†’ å†·å´ = 10 åˆ†é’Ÿï¼ˆæ­£å¸¸ï¼‰

**è®¾è®¡ç†å¿µ**ï¼š
- **ç¦»çº¿å‹å¥½**ï¼šçŸ­æš‚ä¸Šçº¿å³å¯å¤„ç†ç´§æ€¥çŠ¶æ€
- **é¿å…æ­»å¾ªç¯**ï¼šå±æ€§ä½æ—¶ä¸ä¼šé™·å…¥"æ— æ³•æ¢å¤"çš„å›°å¢ƒ
- **æ”¶ç›Šé€’å‡**ï¼šå±æ€§å¥åº·æ—¶å†·å´æ­£å¸¸ï¼Œé¼“åŠ±å¤šå…ƒåŒ–æ“ä½œ

### 3. å¿ƒæƒ…ç³»ç»Ÿ

å¿ƒæƒ…ç”±å±æ€§åŠ æƒè®¡ç®—ï¼š
```
MoodScore = Hunger Ã— 0.25 + Happiness Ã— 0.35 + Health Ã— 0.25 + Energy Ã— 0.15
```

| åˆ†æ•°èŒƒå›´ | å¿ƒæƒ…åç§°   | åŠ¨ç”»çŠ¶æ€  |
|----------|-----------|-----------|
| 81-100   | happy     | AnimHappy |
| 61-80    | normal    | AnimIdle  |
| 41-60    | unhappy   | AnimIdle  |
| 21-40    | sad       | AnimSad   |
| 0-20     | miserable | AnimSad   |

### 4. æˆé•¿è¿›åŒ–ç³»ç»Ÿ

äº”ä¸ªç”Ÿå‘½é˜¶æ®µï¼š

```
Egg â†’ Baby â†’ Child â†’ Adult â†’ Legend
        â”‚       â”‚       â”‚       â”‚
      1é˜¶æ®µ   3åˆ†æ”¯   6åˆ†æ”¯   6åˆ†æ”¯
```

è¿›åŒ–æ¡ä»¶ç»„åˆï¼š
- `min_age_hours` â€” æœ€ä½å¹´é¾„
- `attr_bias` â€” å±æ€§åå¥½ (happiness/health/playful)
- `min_dialogues` / `min_adventures` â€” äº’åŠ¨æ¬¡æ•°
- `min_feed_regularity` â€” å–‚é£Ÿè§„å¾‹æ€§
- `night_interactions_bias` / `day_interactions_bias` â€” æ—¶æ®µåå¥½
- `min_interactions` â€” æ€»äº’åŠ¨æ¬¡æ•°
- `min_attr` â€” å±æ€§é—¨æ§›

### 5. å¯¹è¯ç³»ç»Ÿ

- æŒ‰é˜¶æ®µ + å¿ƒæƒ…åŒ¹é…å¯¹è¯å†…å®¹
- æ”¯æŒé€šé…ç¬¦åŒ¹é…ï¼ˆ`*` åŒ¹é…å…¨éƒ¨é˜¶æ®µ/å¿ƒæƒ…ï¼‰
- æ¯æ¬¡å¯¹è¯éšæœºé€‰å–å€™é€‰å°è¯

#### è‡ªåŠ¨é—²èŠ

å® ç‰©ä¼šåœ¨ TUI ç•Œé¢ä¸»åŠ¨è¯´è¯ï¼š
- æ¯ 3 åˆ†é’Ÿæœ‰ 30% æ¦‚ç‡è§¦å‘è‡ªåŠ¨å¯¹è¯æ°”æ³¡
- å¤±è´¥å 1 åˆ†é’Ÿé‡è¯•
- åŒ¹é…å½“å‰é˜¶æ®µ + å¿ƒæƒ…çš„å¯¹è¯åº“
- åœ¨æ¸¸æˆ/å†’é™©è¿›è¡Œæ—¶ä¸ä¼šè§¦å‘

### 6. å†’é™©ç³»ç»Ÿ

- é€‰é¡¹å¼å†’é™©äº‹ä»¶ï¼Œ4 é˜¶æ®µæµç¨‹ï¼šä»‹ç» â†’ é€‰æ‹© â†’ åŠ¨ç”» â†’ ç»“æœ
- æŒ‰é˜¶æ®µè¿‡æ»¤å¯ç”¨å†’é™©ï¼ˆæ”¯æŒé€šé…ç¬¦å¦‚ `child_*`ï¼‰
- æ¯ä¸ªé€‰é¡¹æœ‰åŠ æƒéšæœºç»“æœï¼ˆ`weight` å­—æ®µæ§åˆ¶æ¦‚ç‡ï¼‰
- ç»“æœå½±å“å±æ€§å€¼ï¼ˆæ˜¾ç¤ºå½©è‰² +/- å˜åŒ–ï¼‰
- å›ºå®šæ¶ˆè€— 10 ç²¾åŠ›ï¼Œå†·å´ 10 åˆ†é’Ÿ
- å®Œæˆæ¬¡æ•° `AdventuresCompleted` è®¡å…¥è¿›åŒ–æ¡ä»¶

### 7. æŒä¹…åŒ–

- JSON æ ¼å¼å­˜æ¡£
- åŸå­å†™å…¥ï¼ˆtmp + renameï¼‰
- é»˜è®¤è·¯å¾„ï¼š`~/.local/share/clipet/save.json`

### 8. æ’ä»¶ç³»ç»Ÿ

- ç‰©ç§/è¿›åŒ–æ ‘é€šè¿‡æ’ä»¶åŒ…åŠ è½½
- å†…ç½®ç‰©ç§ä»¥ `go:embed` æ–¹å¼æ‰“åŒ…
- å¤–éƒ¨æ’ä»¶ä» `~/.local/share/clipet/plugins/` åŠ è½½
- ç»Ÿä¸€çš„ `fs.FS` åŠ è½½æ¥å£
- TOML æè¿°æ ¼å¼

### 9. é…ç½®ç³»ç»Ÿ

é…ç½®æ–‡ä»¶è·¯å¾„ï¼š`~/.config/clipet/config.json`

**é…ç½®é¡¹**ï¼š
- `language`: å½“å‰è¯­è¨€ï¼ˆå¦‚ `zh-CN`ã€`en-US`ï¼‰
- `fallback_language`: å›é€€è¯­è¨€
- `version`: é…ç½®ç‰ˆæœ¬

**è¯­è¨€æ£€æµ‹ä¼˜å…ˆçº§**ï¼š
1. `CLIPET_LANG` ç¯å¢ƒå˜é‡
2. `LANG` ç¯å¢ƒå˜é‡
3. `LC_ALL` ç¯å¢ƒå˜é‡
4. é…ç½®æ–‡ä»¶
5. é»˜è®¤å€¼ (`zh-CN`)

### 10. å›½é™…åŒ–ç³»ç»Ÿ (i18n)

**æ¶æ„**ï¼šé›¶å¤–éƒ¨ä¾èµ–çš„è‡ªç ”è½»é‡çº§æ¡†æ¶

**æ ¸å¿ƒç»„ä»¶**ï¼š
- `internal/i18n/`: Managerã€Bundleã€Loaderã€Plural
- `internal/config/`: é…ç½®ç®¡ç†å’Œè¯­è¨€æ£€æµ‹
- `internal/assets/locales/`: ç¿»è¯‘æ–‡ä»¶ï¼ˆembedï¼‰
- æ’ä»¶ locale æ”¯æŒï¼š`locales/{lang}.json`

**API**ï¼š
```go
i18n.T("ui.home.feed_success", "oldHunger", 50, "newHunger", 75)
i18n.TN("game.stats.interactions", count, "count", count)
```

**ç‰¹æ€§**ï¼š
- æ¨¡æ¿å˜é‡æ’å€¼ (`{{.variable}}`)
- å¤æ•°å¤„ç†
- ç¿»è¯‘å›é€€é“¾ï¼šè¯·æ±‚è¯­è¨€ â†’ å›é€€è¯­è¨€ â†’ å†…è”æ–‡æœ¬
- çº¿ç¨‹å®‰å…¨ï¼ˆRWMutexï¼‰
- ç¼–è¯‘æ—¶ embed ç¿»è¯‘æ–‡ä»¶

**ç¿»è¯‘æ–‡ä»¶ç»“æ„**ï¼š
```
internal/assets/locales/
â”œâ”€â”€ zh-CN/
â”‚   â”œâ”€â”€ tui.json       # TUI ç•Œé¢
â”‚   â”œâ”€â”€ game.json      # æ¸¸æˆé€»è¾‘
â”‚   â””â”€â”€ cli.json       # CLI å‘½ä»¤
â””â”€â”€ en-US/
    â””â”€â”€ ...
```

**å½“å‰æ”¯æŒè¯­è¨€**ï¼š
- ğŸ‡¨ğŸ‡³ ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰- `zh-CN`
- ğŸ‡ºğŸ‡¸ English - `en-US`

## è¿è¡Œæ¨¡å¼

### å…¨å± TUI æ¨¡å¼

```bash
clipet          # å¯åŠ¨å…¨å± TUI äº¤äº’ç•Œé¢
```

### CLI å¿«æ·å‘½ä»¤

```bash
clipet init     # åˆ›å»ºæ–°å® ç‰©
clipet status   # æŸ¥çœ‹å® ç‰©çŠ¶æ€ (-j è¾“å‡º JSON)
clipet          # å¯åŠ¨ TUI ä¸»ç•Œé¢
```

## æ•°æ®è·¯å¾„

| è·¯å¾„                                  | ç”¨é€”             |
|---------------------------------------|-----------------|
| `~/.local/share/clipet/save.json`     | å® ç‰©å­˜æ¡£         |
| `~/.local/share/clipet/plugins/`      | å¤–éƒ¨æ’ä»¶ç›®å½•     |
